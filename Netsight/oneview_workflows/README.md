# How To
## Workflows are available from XMC version 8.1.5 as beta feature. Fully supported in XMC version 8.2 GA
* Import the sctript = In the Extreme Management Center OneView -> Tasks -> Workflow -> Import...

# Extreme Management Center Reporting Workflows
| Workflow name | Description | Comment | Version |
| ------------- | ----------- | ------- | ------- |
|[Aggregated report Device Down](xwf/Aggregated_report_Device_Down-8.2.5.50v6.xwf?raw=true)|This workflow does create aggregated report over the time. Instead of 300 emails if 300 devices goes down, you will get one email with list of 300 devices.|Create Alarm for Device Down based on contact lost and as action assign this workflow. You can define the aggregation time in minutes in the workflow. Define email recipients.|8.2.5.50v6|
|[Link Aggregate Alarm](xwf/Link_Aggregate_Alarm-8.4.0.115v8.xwf?raw=true)|This workflow does create one email for each link down event. Instead of 2 emails if link goes down, you will get one email with all link details.|Create Alarm for Link Down based on selected trap (you can copy or modify original alarm) and as action assign this workflow. Define email recipients.|8.4.0.115v8|
|[ERS inventory](xwf/ERS_Devices_Report-8.4.0.115v106.xwf?raw=true)|This workflow does create one email with CSV file attached. All ERS devices are there with IP, serial numbers and many details.|Select ERS devices. Check your ERS devices do have defined Network OS.|8.4.0.115v106|

# Extreme Management Center Troubleshooting Workflows
| Workflow name | Description | Comment | Version |
| ------------- | ----------- | ------- | ------- |
|[Uptime and Tech Support](xwf/Uptime_and_Tech_Support-8.4.0.115v87.xwf?raw=true)|Does check the uptime of each device (families: Wireless Controller, VSP, Summit Series, Catalyst, Extreme Access Series, VDX). If the uptime is lower then configured value and the device is not in maintenance then the workflow does gather tech support information and send email.|Add XMC to devices with proper CLI credentials. Configure variables and email destination.|8.4.0.115v87|
|[Gather Show Support](xwf/Gather_Show_Support-8.4.0.115v27.xwf?raw=true)|Workflow does gather show support information from devices (families: Wireless Controller, VSP, Summit Series, Catalyst, Extreme Access Series, VDX). Workflow should be executed by alarm or with right click on the device. Workflow does generate email with attached tech support.|Configure the email destination. Create Alarm to execute this workflow. Add XMC to the database with CLI credentials or define XMC credentials in variables.|8.4.0.115v27|

# Extreme Management Center Provisioning Workflows
| Workflow name | Description | Comment | Version |
| ------------- | ----------- | ------- | ------- |
|[Import Site Structure](xwf/Import_Sites-8.2.5.50v2.xwf?raw=true)|Automatically does create sites and subsites based on input file|Inputs: [File site names](xwf/Import_Sites_Sites2Create.txt?raw=true). Parent site must exist.|8.2.5.50v2|
|[Import Devices](xwf/Import_Devices-8.2.6.5v3.xwf?raw=true)|Import devices to the database based on input file|Inputs: [File with devices](xwf/Import_Devices.txt?raw=true). The file contains IP,NickName,Site,Profile. The workflow does finish quickly, added devices will start to appear in the XMC sequentially.|8.2.6.5v3|
|[Import VLANs](xwf/Import_VLANs_to_Site-8.3.0.106v3.xwf?raw=true)|Import VLANs to the Site based on input file|Inputs: [File with VLANs](xwf/Import_VLANs_to_Site.txt?raw=true). The file contains VlanID,VlanName. Chose method ADD (fails if the vlan exist) or REPLACE (if does not exist then it does create the vlan). Specify the Site.|8.3.0.106v3|
|[Import VRFs and VLANs and Services from VSP](xwf/Import_VLANs_and_Services_from_VSP-8.4.0.107v37.xwf?raw=true)|Workflow does read VRFs, VLANs, L2VSN, L3VSN from VSP and import it to Service Defintions.|Inputs: Service Application, VSP device or XA. The Service Definition is determined automatically = VSP must be assigned to the site with Service Definition.|8.4.0.107v37|
|[Import End-Systems to XCA](xwf/Import_CSV_to_XCA_ES_group-8.3.0.111v4.xwf?raw=true)|This workflow does read the CSV file with MACs and descriptions. The workflow does inject the content of the CSV file to end-system group in Extreme Cloud Appliance through the API. The XCA must be in XMC and must have CLI credentials defined. The end-system group must exist. Maximum number of entries in one run is 100 for XCA verion 04.36.02.0014 |Inputs: [File with End-systems](xwf/Import_CSV_to_XCA_ES_group.txt?raw=true). The file contains MAC,description.|8.3.0.111v4|
|[Import L2VSNs to XMC](xwf/Import_L2VSNs-8.3.1.9v7.xwf?raw=true)|Does import VLANs and L2VSNs from file to XMC Service Definitions and Service Applications. If Service Definition does not exist then it is created. If Service Application does not exist then it is created. If Vlan ID does exist then it is updated. If NSI does exist then it is updated. The goal is: You do not need to manually create each VLAN and ISID in XMC.|Inputs: [File with Services](xwf/Import_L2VSNs_Services2Create.txt?raw=true)|8.3.1.9v7|
|[Create Device Groups from Sites](xwf/Create_Device_Groups_from_Sites-8.4.0.115v25.xwf?raw=true)|Based on the Site structure user groups will be created. Workflow does stop if there is a name conflict: if group with the same name already exists. Backup of the XMC is strongly recommended before the workflow execution.|Name of each site must be unique. Restart of XMC is mandatory after the workflow execution.|8.4.0.115v25|

# Extreme Management Center daily job Workflows
| Workflow name | Description | Comment | Version |
| ------------- | ----------- | ------- | ------- |
|[Send System Time by Email](xwf/Send_SystemTime_by_Email-8.2.1.56v22.xwf?raw=true)|Gather system time from group of EXOS devices sequentially and aggregated result is sent by email.|Configure the email recipients before executing.|8.2.1.56v22|
|[Update Device Notes - Group Membership](xwf/Update_Device_Notes-Group_Membership-8.2.4.24v13.xwf?raw=true)|The workflow does modify device property to reflect groups the device belong to.|Modify the Inputs to define what property you want to modify and what prefix you want to use. Run the workflow and save it as task. Schedule the task for periodic execution.|8.2.4.24v13|
|[Synchronize Vlans on the VTP master](xwf/Synchronize_Vlans_on_Catalyst-8.2.5.46v13.xwf?raw=true)|This workflow does create VLANs on the Cisco Catalyst switch based on Site vlan configuration. The workflow does delete VLANs from Cisco Catalyst if the VLAN does not exist in the Site. The workflow does rename VLAN name to match the SITE.|If there was change done then the event is generated.|8.2.5.46v13|
|[Assign Device to User Device Group based on SysObjectID](xwf/Assign_Device_to_UserGroup-8.2.5.50v4.xwf?raw=true)|Automatically does assign device to the user device group based on SysObjectID. All devices of the same type will be in the same user device group.|Inputs:[File with mapping](xwf/Assign_Device_to_UserGroup_SysObjectID2Group.csv?raw=true), SOAP credentials. User device group must exist. Workflow can be executed automatically by Alarm (new device added). Workflow can be executed manually or scheduled.|8.2.5.50v4|
|[Assign Device to User Device Group based on site](xwf/Assign_the_Device_to_User_Device_Group-8.4.0.115v3.xwf=true)|Automatically does assign device to the user device group based on site.|Define SOAP credentials. User device group must exist (Use workflow "Create Device Groups from Sites" to create the user group structure.). Workflow can be executed manually or scheduled or part of the site actions. Multiple devices can be processed by one run.|8.4.0.115v3|
|[Synchronize Vlans on the ERS](xwf/Synchronize_Vlans_on_ERS-8.3.0.111v16.xwf?raw=true)|This workflow does create VLANs on the ERS switch based on Site vlan configuration. The workflow does delete VLANs from ERS if the VLAN does not exist in the Site. The workflow does rename VLAN name to match the SITE.|If there was change done then the event is generated.|8.3.0.111v16|
|[Disable unused ports](xwf/Disable_unused_ports-8.4.0.107v56.xwf?raw=true)|If the port is unused for more than X days then the port is set to Admin-Down state and ifAlias is configured. On EXOS and BOSS and FastPath and ISW devices there is option to save the configuration.|Variable PortDescription does define the ifAlias prefix. Custom Inputs: Topology roles delimited by comma (XMC version 8.3 the roles are numbers starting from 0, XMC version 8.4 roles are "L2 Leaf,L2 Access,...", how many days should be the port down before workflow does take the action, if you do want to save the changed configuration. What sites and subsites you want this workflow to execute. You can schedule the workflow execution in task scheduler.|8.4.0.107v56|
|[Refresh Neighbor Devices](xwf/Refresh_Neighbor_Devices-8.2.4.55v2.xwf?raw=true)|This workflow does check neighbor devices based on XMC link database and does execute refresh of each neighbor. If the device goes down or up then the map is automatically updated.|Create Status Change Alarm and for both contact lost and contact established add action run task with this workflow. |8.2.4.55v2|

# Extreme Management Center NAC-related Workflows
| Workflow name | Description | Comment | Version |
| ------------- | ----------- | ------- | ------- |
|[GDPR - Delete end-system from ExtremeControl](xwf/GDPR-Delete_End-System-8.2.4.41v6.xwf?raw=true)|This workflow does delete End-System with specified MAC from the database.|Various MAC address formats are accepted: lowercase, uppercase, dot delimited, colon delimited, dash delimited, not delimited|8.2.4.41v6|
|[GDPR - Delete from ExtremeControl](xwf/GDPR-Delete-8.2.4.41v4.xwf?raw=true)|This workflow does delete End-System with specified MAC or Username from the database.|Various MAC address formats are accepted: lowercase, uppercase, dot delimited, colon delimited, dash delimited, not delimited. Domain is not mandatory in the username.|8.2.4.41v4|
|[Investigate End-System History](xwf/Investigate_End-System_history-8.2.5.50v48.xwf?raw=true)|Workflow does generate email with details from end-system history based on defined criteria.|Input:MAC or Username, Date range. Define email recepients before use.|8.2.5.50v48|
|[Remove all End-Systems from group](xwf/Clear_End-Systems_in_the_group-8.3.1.9v12.xwf?raw=true)|This workflow does remove all end-systems from end-system group. It can be scheduled to execute periodically.|Define end-system group in variable "EndSystemGroup" default end-system group: "Access Expired".|8.3.1.9v12|
|[Investigate End-System history](xwf/Investigate_End-System_history-8.2.5.50v48.xwf?raw=true)|Prompt for MAC or Username and for time range. Workflow does create table of end-system events in the database and send it by email.|Configure the email recipients before executing. Variable InstallDirectory is referring to the XMC installation path.|8.2.5.50v48|
|[Import credentials from MySQL to local repository](xwf/MySQL-2-LocalRepository-8.4.0.115v13.xwf?raw=true)|Workflow does connect to external MySQL server and read usernames and passwords. These are then injected to the local password repository. Can be executed once, can be scheduled.|Input:SQL server, SQL username, SQL password, SQL database, SQL table, Column with username, Column with password.|8.4.0.115v13|

# Extreme Management Center Workflow Combinations
| Name | Workflows | Description | How To | Version |
| ---- | --------- | ----------- | ------ | ------- |
|User authenticated on domain computer|[Add MAC to Domain Computers](combo/UserAndComputer/Add_MAC_to_Domain_Computers-8.3.1.9v3.xwf?raw=true) [Clear old End-Systems in the group](combo/UserAndComputer/Clear_old_End-Systems_in_the_group-8.3.1.9v5.xwf?raw=true)|"Add MAC to Domain Computers" is executed when computer authenticates. The MAC address is added to End-System and timestamp is created (updated). Consequent User authentication can be combined with condition of End-System group. "Clear old End-Systems in the group" does check if the timestamp is older than X hours and old End-Systems are deleted from the group.|Create End-System group "Domain Computers". Create User Group [Username starts with host/](combo/UserAndComputer/UserGroup.PNG). Create notification [Domain authentication - after logoff](combo/UserAndComputer/Notification1.PNG). Create notification [Domain authentication - after boot](combo/UserAndComputer/Notification2.PNG). Configure inputs for workflows. Schedule the workflow execution to clean old end-systems from End-Systems group. Create [NAC rule](combo/UserAndComputer/Rule.PNG)|8.3.1.9v3 8.3.1.9v5|
|Add NSI to Vlan Egress = After Policy Enforcement|[Run Add NSI After Policy Enforcement](combo/AddNSIprefix/Run_Add_NSI_After_Policy_Enforcement-8.4.0.107v11.xwf?raw=true) [Add NSI prefix to vlan egress](combo/AddNSIprefix/Add_NSI_prefix_to_vlan_egress-8.3.1.9v35.xwf?raw=true)|There maybe tagged egress vlans in the policy profiles. This workflow does ensure these egress vlans are mapped to proper NSI on EXOS switch. This check is executed on each reachable device in the policy domain, when the enforce is completed.|Import both workflows. The "Run Add NSI After Policy Enforcement" should be executable by [Alarm](combo/AddNSIprefix/Alarm.png). Configure the [path](combo/AddNSIprefix/WorkflowPath.png) to the "Add NSI prefix to vlan egress" workflow. [Create Alarm](combo/AddNSIprefix/AlarmDefinition.png) to execute the workflow if the policy domain is enforced. Create [topology](combo/AddNSIprefix/Topology.png) if you do not have any. Create [Service and Application](combo/AddNSIprefix/Applications.png). Assign [Topology](combo/AddNSIprefix/SiteTopology.png) to the Site. Assign [Service](combo/AddNSIprefix/SiteService.png) Definition to the Site.|8.4.0.107v11 8.3.1.9v35|

# Support
_The software is provided as-is and [Extreme Networks](http://www.extremenetworks.com/) has no obligation to provide maintenance, support, updates, enhancements, or modifications. Any support provided by [Extreme Networks](http://www.extremenetworks.com/) is at its sole discretion._

Issues and/or bug fixes may be reported on [The Hub](https://community.extremenetworks.com).
>Be Extreme
